A8255_CON EQU 0606H
A8255_A EQU 0600H
A8255_B EQU 0602H
A8255_C EQU 0604H
DATA	SEGMENT
	TABLE	DB	3FH
			DB	06H
			DB	5BH
			DB	4FH
			DB	66H
			DB	6DH
			DB	7DH
			DB	07H
			DB	7FH
			DB	6FH
	NUM		DB	01H
DATA	ENDS
CODE	SEGMENT
	ASSUME	DS:DATA,CS:CODE
START:	MOV	AX,DATA
		MOV	DS,AX
		LEA	SI,TABLE
		MOV	DX,A8255_CON
		MOV	AL,89H
		OUT	DX,AL
AA1:	MOV	NUM,01H
		MOV	CX,6
AA2:	CALL	NOW
		ADD	NUM,1
		LOOP	AA2
		JMP	AA1
		HLT


NOW		PROC	NEAR
		PUSH	CX
		PUSH	AX
		MOV	BL,NUM
		MOV	BH,0
		MOV	CX,7
		SUB	CX,BX
		MOV	AH,11011111B
ZZ1:	PUSH	CX
		MOV	CX,0FFH
ZZ2:	
		CALL	PRE
		MOV	AL,[BX+SI]
		MOV	DX,A8255_B
		OUT	DX,AL
		MOV	AL,AH
		MOV	DX,A8255_A
		OUT	DX,AL
		CALL	DELAY1
		LOOP	ZZ2
		POP		CX
		ROR		AH,1
		CALL	DELAY1
		LOOP	ZZ1
		
		POP		AX
		POP		CX
		RET
NOW		ENDP


PRE		PROC	NEAR
		PUSH	CX
		PUSH	AX
		PUSH	BX
		MOV	CX,0
YY5:	MOV	AH,11111110B
		MOV	BX,1
		CMP	BL,NUM
		JZ	YY2

YY1:	CMP	BL,NUM
		JZ	YY4
		CMP	CX,5
		JZ	YY3
		MOV	AL,[BX+SI]
		MOV	DX,A8255_B
		OUT	DX,AL
		MOV	AL,AH
		MOV	DX,A8255_A
		OUT	DX,AL
		ROL		AH,1
		INC		BX
		INC		CX
		CALL	DELAY1
		JMP	YY1

YY2:	CMP	BX,6
		JZ	YY3
		CALL	DELAY1
		INC	BX
		JMP	YY2

YY4:	CMP	CX,5
		JB	YY5

YY3:	POP		BX
		POP		AX
		POP		CX
		RET
PRE		ENDP

DELAY	PROC	NEAR
		PUSH	CX
		MOV	CX,0FFFFH
XX1:	LOOP	XX1	
		POP	CX
		RET
DELAY	ENDP

DELAY1	PROC	NEAR
		PUSH	CX
		MOV	CX,0FFH
XX3:	LOOP	XX3
		POP CX
		RET
DELAY1	ENDP
CODE	ENDS
END	START
		
					